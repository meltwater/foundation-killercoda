Let's learn to write a simple python script using Grafanalib library, that will generate a dashboard json file and have it deployed to Grafana.

From grafanalib.core library import the required planel types, dashboard type and other required functions to upload and get dashboard json from Grafana.
Copy and paste the below code block into `dashboard.py` file, which you can found under `Editor` tab.

Here `GRAFANA_API_KEY` and `GRAFANA_SERVER` are provided as environmental variables in later stage.


```
from grafanalib.core import Dashboard, TimeSeries, GaugePanel,Target, GridPos, OPS_FORMAT, Template,Templating, Table, TABLE_TARGET_FORMAT, Column
from grafanalib._gen import DashboardEncoder
import json
import requests
from os import getenv


def get_dashboard_json(dashboard, overwrite=False, message="Updated by grafanlib"):
    '''
    get_dashboard_json generates JSON from grafanalib Dashboard object

    :param dashboard - Dashboard() created via grafanalib
    '''

    # grafanalib generates json which need to pack to "dashboard" root element
    return json.dumps(
        {
            "dashboard": dashboard.to_json_data(),
            "overwrite": overwrite,
            "message": message
        }, sort_keys=True, indent=2, cls=DashboardEncoder)


def upload_to_grafana(json, server, api_key, verify=True):
    '''
    upload_to_grafana tries to upload dashboard to grafana and prints response

    :param json - dashboard json generated by grafanalib
    :param server - grafana server name
    :param api_key - grafana api key with read and write privileges
    '''

    headers = {'Authorization': f"Bearer {api_key}", 'Content-Type': 'application/json'}
    r = requests.post(f"{server}/api/dashboards/db", data=json, headers=headers, verify=verify)
    # TODO: add error handling
    print(f"{r.status_code} - {r.content}")


grafana_api_key = getenv("GRAFANA_API_KEY")
grafana_server = getenv("GRAFANA_SERVER")
```{{copy}}


Create a dashboard instance with all the required fields, like the dashboard title, description, tags, panels just like you would create a dashboard with panels in Grafana UI.
We are using prometheus datasource here for ur example dashboard


```
my_dashboard = Dashboard(
    title="Prometheus 2.0 Overview - KillerCoda",
    editable=False,
    description="Example dashboard using Prometheus datasource",

    tags=[
        'Dashboard-As-Code',
        'killercoda'
    ],
    timezone="browser",
    panels=[
        TimeSeries(
            title="Scrape Duration",
            dataSource='default',
            targets=[
                Target(
                    datasource='gdev-prometheus',
                    expr='scrape_duration_seconds{instance="localhost:9090"}',
                ),
            ],
            gridPos=GridPos(h=8, w=8, x=0, y=0),
        ),
        TimeSeries(
            title="Minutes Since Successful Config Reload",
            dataSource='default',
            targets=[
                Target(
                    datasource='gdev-prometheus',
                    expr='(time() - prometheus_config_last_reload_success_timestamp_seconds{job="prometheus",instance="localhost:9090"}) / 60',
                ),
            ],
            unit=OPS_FORMAT,
            gridPos=GridPos(h=8, w=8, x=0, y=10),
        ),
    ],
).auto_panel_ids()

my_dashboard_json = get_dashboard_json(my_dashboard, overwrite=True)
upload_to_grafana(my_dashboard_json, grafana_server, grafana_api_key)
```{{copy}}

You can see that we are creating a dashboard with just two panels of type TimeSeries with Prometheus Datasource. One of the panels is querying `scrape_duration_seconds` prometheus metric, while the other is querying `prometheus_config_last_reload_success_timestamp_seconds` prometheus metric.